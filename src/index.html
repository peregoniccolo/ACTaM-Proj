<html>

<head>
    <title>GranSynth</title>

    <link rel="stylesheet" href="style.css" />
    <!-- wavesurfer -->
    <script src="https://unpkg.com/wavesurfer.js/dist/wavesurfer.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js/dist/plugin/wavesurfer.cursor.min.js"></script>
    <!-- jquery & knobs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js"></script>
    <!-- bootstrap & popperjs -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
</head>

<body>

    <h1>
        <div class="words word-1">
            <span>G</span>
            <span>r</span>
            <span>a</span>
            <span>n</span>
            <span>u</span>
            <span>l</span>
            <span>a</span>
            <span>r</span>
            <span>S</span>
            <span>y</span>
            <span>n</span>
            <span>t</span>
            <span>h</span>
            <span>e</span>
            <span>t</span>
            <span>i</span>
            <span>z</span>
            <span>e</span>
            <span>r</span>
        </div>

    </h1>

    <div class='nodisplay container waveform-container rounded' id="wave-container">
        <div class="waveform" id="waveform"></div>
    </div>

    <div class='container nodisplay' id="bar-container">
        <div class="bar row rounded mt-3 p-2" id="knob-bar">
            <!-- granular parameter bar -->
            <div class="col-2 knob-col">
                <input id="density-knob" class="knob par-knob animated" default="0.5" data-min="0" data-max="1" />
                <label class="label-style">Density</label>
            </div>
            <div class="col-2 knob-col">
                <input id="spread-knob" class="knob par-knob animated" default="0.5" data-min="0" data-max="1" />
                <label class="label-style">Spread</label>
            </div>
            <div class="col-2 knob-col">
                <input id="pitch-knob" class="knob par-knob animated" default="0.5" data-min="0" data-max="1" />
                <label class="label-style">Pitch</label>
            </div>
            <div class="col-2 knob-col">
                <input id="attack-knob" class="knob env-knob animated" default="0.1" data-min="0.01" data-max="1" />
                <label class="label-style">Attack</label>
            </div>
            <div class="col-2 knob-col">
                <input id="release-knob" class="knob env-knob animated" default="0.5" data-min="0.01" data-max="1" />
                <label class="label-style">Release</label>
            </div>
            <div class="col-2 knob-col">
                <input id="volume-knob" class="knob animated" default="0.5" data-min="0" data-max="1" />
                <label class="label-style">Volume</label>
            </div>
        </div>

        <div class="row justify-content-center m-3">
            <div class="col-4" style="min-width: 365px;">
                <div class="form-floating">
                    <select id="preset-select" class="form-select select-style">
                        <!-- populated in js -->
                    </select>
                    <label for="preset-select">Select a preset for the granular parameters</label>
                </div>
            </div>
        </div>


        <div class="bar row rounded p-2" id="effect-bar">
            <!-- first row: delay and reverb -->
            <div class="row justify-content-around">


                <div class="col-5 mb-3 effect-box rounded" id="delay">
                    <div class='row title-effect'>
                        <div class="col-2">
                            <button id='delay-toggle' class="toggle"></button>
                        </div>
                        <div class="col-10 eff-name-up">
                            Delay
                        </div>
                    </div>
                    <div class="row justify-content-around">
                        <div class="col-5 knob-col-small">
                            <input id="feedback-knob" class="knob animated" default="0.4" data-min="0"
                                data-max="0.75" />
                            <label class="label-style">Feedback</label>
                        </div>
                        <div class="col-5 knob-col-small">
                            <input id="delay-knob" class="knob animated" default="0.5" data-min="0" data-max="1" />
                            <label class="label-style">Time</label>
                        </div>
                    </div>
                </div>


                <div class="col-5 mb-3 effect-box rounded" id="reverb">
                    <div class='row title-effect'>
                        <div class="col-2">
                            <button id='reverb-toggle' class="toggle"></button>
                        </div>
                        <div class="col-10 eff-name-up">
                            Reverb
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-12 knob-col-small">
                            <input id="decay-knob" class="knob animated" default="3" data-min="0" data-max="10" />
                            <label class="label-style">Decay</label>
                        </div>
                    </div>
                </div>
            </div>



            <!-- second row: distortion and lpf -->
            <div class="row justify-content-around">
                <div class="col-5 effect-box rounded" id="distortion">
                    <div class='row title-effect'>
                        <div class="col-2">
                            <button id='distortion-toggle' class="toggle"></button>
                        </div>
                        <div class="col-10 eff-name-down">
                            Distortion
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-12 knob-col-small">
                            <input id="amount-knob" class="knob animated" default="3" data-min="1" data-max="10" />
                            <label class="label-style">Amount</label>
                        </div>
                    </div>
                </div>


                <div class="col-5 effect-box rounded" id="lpf">
                    <div class='row title-effect'>
                        <div class="col-2">
                            <button id='lpf-toggle' class="toggle"></button>
                        </div>
                        <div class="col-2 eff-name-down">
                            LPF
                        </div>
                    </div>
                    <div class="row justify-content-around">
                        <div class="col-5 knob-col-small">
                            <input id="freq-knob" class="knob animated" default="3000" data-min="10" data-max="9999" />
                            <label class="label-style">Cut off</label>
                        </div>
                        <div class="col-5 knob-col-small">
                            <input id="resonance-knob" class="knob animated" default="0.5" data-min="0.01"
                                data-max="1" />
                            <label class="label-style">Resonance</label>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="container drop_zone">
        <span class="drop_zone_prompt">Drag your sample here...</span>
        <input type="file" accept="audio/*" id="dft-sample" name="myFile" class="drop_zone_input" />
    </div>

    <div class="container" id="sample-container">
        <div class="row justify-content-center mt-5">
            <div class="col-2" style="min-width: 135px">
                <div id='sample1' class="dft-sample">Sample 1</div>
            </div>

            <div class="col-2" style="min-width: 135px">
                <div id='sample2' class="dft-sample">Sample 2</div>
            </div>
        </div>
    </div>

    <div class="container nodisplay" id="button-container">

        <div class="row justify-content-center m-3">
            <div class="col-3 mb-4" style="min-width: 185px">
                <button id='reverse' class="big-green-btn">Reverse sample</button>
            </div>
            <div class="col-3 mb-4" style="min-width: 185px">
                <button id="new_sample_but" class="big-green-btn">Change sample</button>
            </div>
            <div class="col-3 mb-4" style="min-width: 185px">
                <button id="popupButton" class="big-green-btn">Controllers</button>
            </div>
        </div>
    </div>

    <div class="container nodisplay" id="popup-container">
        <div class="popup row justify-content-center m-3">
            <div class="popuptext col-10" id="myPopup">
                <div class="row justify-content-around p-3 pb-1">
                    <div class="col-4 mb-3" style="min-width: 225px;">
                        <div class="row gx-1">
                            <div class="col-4">
                                <span class="ttover" data-bs-placement="top"
                                    title="Click this box and twist the MIDI knob you want to associate with the selected parameter!">
                                    <input class="form-control mouse-over-cursor" id="controller1" readonly />
                                </span>
                            </div>
                            <div class="col-8">
                                <select class="form-select select-style" id="select1">
                                    <option value="density-knob">Density</option>
                                    <option value="pitch-knob">Pitch</option>
                                    <option value="spread-knob">Spread</option>
                                    <option value="attack-knob">Attack</option>
                                    <option value="release-knob">Release</option>
                                    <option value="volume-knob">Volume</option>
                                </select>
                            </div>

                        </div>
                    </div>

                    <div class="col-4 mb-3" style="min-width: 225px;">
                        <div class="row gx-1">
                            <div class="col-4">
                                <span class="ttover" data-bs-placement="top"
                                    title="Click this box and twist the MIDI knob you want to associate with the selected parameter!">
                                    <input class="form-control mouse-over-cursor" id="controller2" readonly />
                                </span>
                            </div>
                            <div class="col-8">
                                <select class="form-select select-style" id="select2">
                                    <option value="density-knob">Density</option>
                                    <option value="pitch-knob">Pitch</option>
                                    <option value="spread-knob">Spread</option>
                                    <option value="attack-knob">Attack</option>
                                    <option value="release-knob">Release</option>
                                    <option value="volume-knob">Volume</option>
                                </select>
                            </div>

                        </div>
                    </div>

                    <div class="col-4 mb-3" style="min-width: 225px;">
                        <div class="row gx-1">
                            <div class="col-4">
                                <span class="ttover" data-bs-placement="top"
                                    title="Click this box and twist the MIDI knob you want to associate with the selected parameter!">
                                    <input class="form-control mouse-over-cursor" id="controller3" readonly />
                                </span>
                            </div>
                            <div class="col-8">
                                <select class="form-select select-style" id="select3">
                                    <option value="density-knob">Density</option>
                                    <option value="pitch-knob">Pitch</option>
                                    <option value="spread-knob">Spread</option>
                                    <option value="attack-knob">Attack</option>
                                    <option value="release-knob">Release</option>
                                    <option value="volume-knob">Volume</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center p-3 pt-1">
                    <div class="col-4" style="min-width: 225px;">
                        <button id="controllerset" class="btn">Set!</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <footer>
        <p><a href="https://github.com/peregoniccolo/ACTaM-Proj">ACTaM Project</a> - Developed by Gargiulo,
            Morena, Orsatti, Perego</p>
    </footer>

    <script src="script.js"></script>
    <script>
        // generate tooltips
        const tooltips = document.querySelectorAll(".ttover");
        tooltips.forEach(t => {
            new bootstrap.Tooltip(t);
        });
    </script>
</body>

</html>